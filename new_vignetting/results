Из результатов видно, что для получения эффекта виньетирования коэффиценты функции должны быть следущих знаков:
A < 0
B < 0
C < 0
D > 0
E > 0

Test 1:
Real data:
0.1 0.1 0.1 0.1
0.1 0.2 0.2 0.1
0.1 0.2 0.2 0.1
0.1 0.1 0.1 0.1

Predicted data:
-0.1645 0.0159 0.0893 0.0557
0.0159 0.1612 0.1996 0.1309
0.0893 0.1996 0.2028 0.0991
0.0557 0.1309 0.0991 -0.0397

Parameters:
A: -0.85613
B: -0.85613
C: -0.56097
D: 0.93564
E: 0.93564
F: -0.16450

Test 2:
Real data:
0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1
0.1 0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.1
0.1 0.2 0.2 0.3 0.3 0.3 0.3 0.2 0.2 0.1
0.1 0.2 0.2 0.4 0.4 0.4 0.4 0.2 0.2 0.1
0.1 0.2 0.2 0.4 0.5 0.5 0.5 0.2 0.2 0.1
0.1 0.2 0.2 0.4 0.5 0.5 0.5 0.2 0.2 0.1
0.1 0.2 0.2 0.4 0.4 0.4 0.4 0.2 0.2 0.1
0.1 0.2 0.2 0.3 0.3 0.3 0.3 0.2 0.2 0.1
0.1 0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.1
0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1

Predicted data:
-0.0144 0.0706 0.1329 0.1725 0.1894 0.1837 0.1554 0.1044 0.0307 -0.0657
0.0666 0.1526 0.2160 0.2566 0.2747 0.2700 0.2427 0.1928 0.1201 0.0248
0.1258 0.2129 0.2773 0.3190 0.3381 0.3345 0.3083 0.2594 0.1878 0.0936
0.1632 0.2514 0.3168 0.3596 0.3798 0.3773 0.3521 0.3043 0.2338 0.1406
0.1789 0.2681 0.3346 0.3785 0.3997 0.3982 0.3741 0.3274 0.2579 0.1658
0.1728 0.2630 0.3306 0.3756 0.3978 0.3974 0.3744 0.3287 0.2603 0.1693
0.1449 0.2362 0.3049 0.3509 0.3742 0.3749 0.3529 0.3082 0.2409 0.1509
0.0952 0.1876 0.2573 0.3044 0.3288 0.3305 0.3096 0.2660 0.1998 0.1108
0.0238 0.1172 0.1880 0.2361 0.2616 0.2644 0.2445 0.2020 0.1368 0.0490
-0.0694 0.0251 0.0969 0.1461 0.1727 0.1765 0.1577 0.1163 0.0521 -0.0347

Parameters:
A: -1.08858
B: -1.13313
C: 0.10626
D: 0.91855
E: 0.96279
F: -0.01436

Test 3:
Real data:
0.1 0.1 0.1 0.1
0.1 0.2 0.2 0.1
0.1 0.3 0.3 0.1
0.1 0.4 0.3 0.1
0.1 0.5 0.5 0.1
0.1 0.6 0.6 0.1
0.1 0.7 0.7 0.1
0.1 0.8 0.8 0.1
0.1 0.7 0.7 0.1
0.1 0.6 0.6 0.1
0.1 0.5 0.5 0.1
0.1 0.4 0.4 0.1
0.1 0.3 0.3 0.1
0.1 0.2 0.2 0.1
0.1 0.1 0.1 0.1

Predicted data:
-0.2787 0.1648 0.2541 -0.0109
-0.1774 0.2527 0.3287 0.0504
-0.0879 0.3288 0.3914 0.0997
-0.0103 0.3931 0.4422 0.1372
0.0554 0.4454 0.4812 0.1628
0.1092 0.4859 0.5083 0.1765
0.1512 0.5144 0.5235 0.1783
0.1813 0.5311 0.5268 0.1683
0.1995 0.5360 0.5183 0.1464
0.2058 0.5289 0.4978 0.1126
0.2002 0.5100 0.4655 0.0669
0.1828 0.4792 0.4213 0.0093
0.1534 0.4365 0.3653 -0.0601
0.1122 0.3819 0.2973 -0.1414
0.0592 0.3154 0.2175 -0.2346

Parameters:
A: -1.33646
B: -2.83361
C: -0.80235
D: 1.60937
E: 2.48235
F: -0.27872

Test 4:
Real data:
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
0 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0
0 0.05 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.05 0
0 0.05 0.1 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.1 0.05 0
0 0.05 0.1 0.25 0.3 0.3 0.3 0.3 0.3 0.3 0.3 0.25 0.1 0.05 0
0 0.05 0.1 0.25 0.3 0.4 0.5 0.5 0.5 0.4 0.3 0.25 0.1 0.05 0
0 0.05 0.1 0.25 0.3 0.4 0.5 0.5 0.5 0.4 0.3 0.25 0.1 0.05 0
0 0.05 0.1 0.25 0.3 0.4 0.5 0.5 0.5 0.4 0.3 0.25 0.1 0.05 0
0 0.05 0.1 0.25 0.3 0.4 0.5 0.5 0.5 0.4 0.3 0.25 0.1 0.05 0
0 0.05 0.1 0.25 0.3 0.4 0.4 0.4 0.4 0.4 0.3 0.25 0.1 0.05 0
0 0.05 0.1 0.25 0.3 0.3 0.3 0.3 0.3 0.3 0.3 0.25 0.1 0.05 0
0 0.05 0.1 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.25 0.1 0.05 0
0 0.05 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.05 0
0 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0.05 0
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0

Predicted data:
-0.4270 -0.3446 -0.2713 -0.2070 -0.1517 -0.1054 -0.0682 -0.0399 -0.0207 -0.0105 -0.0093 -0.0171 -0.0339 -0.0598 -0.0946
-0.3450 -0.2631 -0.1902 -0.1264 -0.0715 -0.0257 0.0111 0.0389 0.0577 0.0674 0.0682 0.0599 0.0426 0.0163 -0.0190
-0.2720 -0.1906 -0.1182 -0.0548 -0.0004 0.0450 0.0814 0.1087 0.1270 0.1364 0.1367 0.1279 0.1102 0.0834 0.0477
-0.2080 -0.1271 -0.0551 0.0079 0.0618 0.1067 0.1427 0.1695 0.1874 0.1963 0.1961 0.1870 0.1688 0.1416 0.1053
-0.1530 -0.0725 -0.0010 0.0615 0.1150 0.1595 0.1950 0.2214 0.2388 0.2472 0.2466 0.2370 0.2184 0.1907 0.1540
-0.1070 -0.0269 0.0441 0.1062 0.1592 0.2033 0.2383 0.2642 0.2812 0.2892 0.2881 0.2780 0.2589 0.2308 0.1937
-0.0700 0.0096 0.0803 0.1419 0.1944 0.2380 0.2726 0.2981 0.3146 0.3221 0.3206 0.3101 0.2906 0.2620 0.2244
-0.0420 0.0372 0.1074 0.1685 0.2207 0.2638 0.2979 0.3230 0.3391 0.3461 0.3442 0.3332 0.3132 0.2842 0.2461
-0.0229 0.0558 0.1255 0.1862 0.2379 0.2806 0.3142 0.3389 0.3545 0.3611 0.3587 0.3473 0.3268 0.2974 0.2589
-0.0128 0.0654 0.1347 0.1950 0.2462 0.2884 0.3216 0.3458 0.3610 0.3671 0.3642 0.3524 0.3315 0.3015 0.2626
-0.0118 0.0661 0.1349 0.1947 0.2455 0.2872 0.3200 0.3437 0.3584 0.3641 0.3608 0.3485 0.3271 0.2968 0.2574
-0.0197 0.0577 0.1261 0.1854 0.2357 0.2770 0.3093 0.3326 0.3469 0.3521 0.3484 0.3356 0.3138 0.2830 0.2431
-0.0366 0.0403 0.1083 0.1671 0.2170 0.2579 0.2897 0.3126 0.3264 0.3312 0.3270 0.3137 0.2915 0.2602 0.2199
-0.0625 0.0140 0.0815 0.1399 0.1893 0.2297 0.2611 0.2835 0.2969 0.3012 0.2966 0.2829 0.2602 0.2284 0.1877
-0.0974 -0.0213 0.0457 0.1037 0.1527 0.1926 0.2236 0.2455 0.2584 0.2623 0.2572 0.2430 0.2199 0.1877 0.1465

Parameters:
A: -1.01115
B: -1.01434
C: -0.10156
D: 1.29691
E: 1.30279
F: -0.42698

Test 5:
Real data:
0.234 0.234 0.234 0.234 0.234 0.234 0.234 0.234 0.234 0.234
0.234 0.456 0.456 0.456 0.456 0.456 0.456 0.456 0.456 0.234
0.234 0.456 0.678 0.678 0.678 0.678 0.678 0.678 0.456 0.234
0.234 0.456 0.678 0.901 0.901 0.901 0.901 0.678 0.456 0.234
0.234 0.456 0.678 0.901 1 1 0.901 0.678 0.456 0.234
0.234 0.456 0.678 0.901 1 1 0.901 0.678 0.456 0.234
0.234 0.456 0.678 0.901 0.901 0.901 0.901 0.678 0.456 0.234
0.234 0.456 0.678 0.678 0.678 0.678 0.678 0.678 0.456 0.234
0.234 0.456 0.456 0.456 0.456 0.456 0.456 0.456 0.456 0.234
0.234 0.234 0.234 0.234 0.234 0.234 0.234 0.234 0.234 0.234

Predicted data:
-0.5783 -0.3678 -0.1949 -0.0597 0.0380 0.0980 0.1204 0.1052 0.0523 -0.0381
-0.3678 -0.1724 -0.0146 0.1055 0.1881 0.2330 0.2403 0.2100 0.1421 0.0365
-0.1949 -0.0146 0.1281 0.2331 0.3006 0.3304 0.3226 0.2772 0.1942 0.0735
-0.0597 0.1055 0.2331 0.3231 0.3754 0.3902 0.3673 0.3068 0.2087 0.0729
0.0380 0.1881 0.3006 0.3754 0.4127 0.4123 0.3744 0.2987 0.1855 0.0347
0.0980 0.2330 0.3304 0.3902 0.4123 0.3969 0.3438 0.2531 0.1248 -0.0412
0.1204 0.2403 0.3226 0.3673 0.3744 0.3438 0.2756 0.1698 0.0264 -0.1546
0.1052 0.2100 0.2772 0.3068 0.2987 0.2531 0.1698 0.0489 -0.1096 -0.3057
0.0523 0.1421 0.1942 0.2087 0.1855 0.1248 0.0264 -0.1096 -0.2832 -0.4944
-0.0381 0.0365 0.0735 0.0729 0.0347 -0.0412 -0.1546 -0.3057 -0.4944 -0.7208

Parameters:
A: -1.88097
B: -1.88097
C: -1.50968
D: 2.29309
E: 2.29309
F: -0.57831













